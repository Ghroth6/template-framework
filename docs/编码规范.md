# TempleFrameWork (TFW) 缂栫爜瑙勮寖

## 1. 鎬讳綋鍘熷垯

### 1.1 浠ｇ爜璐ㄩ噺瑕佹眰
浠ｇ爜闇€瑕佸湪淇濊瘉鍔熻兘姝ｇ‘鐨勫墠鎻愪笅锛屾弧瓒?*鍙銆佸彲缁存姢銆佸畨鍏ㄣ€佸彲闈犮€佸彲娴嬭瘯銆侀珮鏁堛€佸彲绉绘**鐨勭壒寰佽姹傘€?
### 1.2 瑙勮寖閬靛畧
- **瑙勫垯**: 缂栫▼鏃跺繀椤婚伒瀹堢殑绾﹀畾
- **寤鸿**: 缂栫▼鏃跺簲璇ヨ€冭檻鐨勭害瀹?- 鐞嗚В姣忔潯瑙勮寖鐨勫師鍥狅紝骞跺姫鍔涢伒瀹?- 渚嬪鎯呭喌闇€缁忚繃鍏呭垎鑰冭檻骞舵湁鍏呰冻鐞嗙敱

### 1.3 椤圭洰鐗瑰畾绾﹀畾
- 浣跨敤 `TFW_` 浣滀负涓存椂鍓嶇紑閬垮厤鍛藉悕鍐茬獊
- 鍛藉悕绌洪棿浣跨敤 `TFW::`
- 澶存枃浠朵繚鎶ゅ畯鏍煎紡: `TFW_FILENAME_H`
- 浼樺厛浣跨敤 C++20 鐗规€?- **C鎺ュ彛鍏煎鎬?*: 鏍稿績鎺ュ彛蹇呴』鎻愪緵C璇█鍏煎鐗堟湰

## 2. 鍛藉悕瑙勮寖

### 2.1 閫氱敤鍛藉悕椋庢牸
| 绫诲瀷 | 鍛藉悕椋庢牸 |
|------|----------|
| 绫汇€佺粨鏋勪綋銆佹灇涓俱€佽仈鍚堜綋 | 澶ч┘宄?(UpperCamelCase) |
| 鍑芥暟 | 澶ч┘宄?|
| 鍙橀噺銆佸嚱鏁板弬鏁般€佹垚鍛樺彉閲?| 灏忛┘宄?(lowerCamelCase) |
| 瀹忋€佸父閲忋€佹灇涓惧€?| 鍏ㄥぇ鍐欙紝涓嬪垝绾垮垎闅?|
| 鍏ㄥ眬鍙橀噺 | 灏忛┘宄帮紝浠?`g_` 寮€澶?|
| **C鎺ュ彛鍑芥暟** | **鍏ㄥぇ鍐欙紝涓嬪垝绾垮垎闅旓紝浠ユā鍧楀悕寮€澶?* |

### 2.2 鏂囦欢鍛藉悕
- 澶存枃浠? `.h` 鍚庣紑锛岃泧褰㈠懡鍚嶆硶
- 婧愭枃浠? `.cpp` 鍚庣紑锛屼笌澶存枃浠跺搴?- 鏂囦欢鍚嶄笌涓昏绫诲悕淇濇寔涓€鑷?
### 2.3 绀轰緥
```cpp
// 绫诲悕
class TFWServerFrame;

// 鍑芥暟鍚?void InitializeEngine();

// 鍙橀噺鍚?int playerCount;
string playerName;

// 鎴愬憳鍙橀噺
bool initialized_;
int connectionCount_;

// 鍏ㄥ眬鍙橀噺
int g_totalConnections;
string g_defaultConfig;

// 甯搁噺
const int MAX_PLAYERS = 8;
#define TFW_LOG_LEVEL_INFO

// C鎺ュ彛鍑芥暟
extern "C" {
    int TFW_CORE_INITIALIZE();
    int TFW_CORE_EXIT();
    int TFW_UTILS_GET_VERSION(char* version, int maxLen);
}
```

## 3. 鏍煎紡瑙勮寖

### 3.1 缂╄繘涓庣┖鏍?- 浣跨敤绌烘牸缂╄繘锛屾瘡娆＄缉杩?涓┖鏍?- 琛屽涓嶈秴杩?20涓瓧绗?- 鎿嶄綔绗﹀墠鍚庡姞绌烘牸锛岄€楀彿鍚庡姞绌烘牸

### 3.2 澶ф嫭鍙烽鏍?```cpp
// K&R 椋庢牸
class MyClass {
public:
    MyClass() : value(0) {}

    void Function() {
        if (condition) {
            // ...
        } else {
            // ...
        }
    }
private:
    int value;
};
```

### 3.3 鎸囬拡鍜屽紩鐢?```cpp
int* ptr = nullptr;    // 姝ｇ‘
int &ref = value;      // 姝ｇ‘

int* ptr1, ptr2;       // 閿欒: ptr2 涓嶆槸鎸囬拡
```

## 4. 鍑芥暟璁捐

### 4.1 鍑芥暟闀垮害
- 鍑芥暟涓嶈秴杩?0琛岋紙闈炵┖闈炴敞閲婏級
- 閬垮厤杩囨繁鐨勫祵濂楋紙涓嶈秴杩?灞傦級

### 4.2 鍙傛暟璁捐
- 鍙傛暟涓暟涓嶈秴杩?涓?- 浣跨敤寮曠敤浠ｆ浛鎸囬拡浣滀负鍙傛暟
- 杈撳嚭鍙傛暟鏀惧湪鍙傛暟鍒楄〃鏈€鍚?
### 4.3 绀轰緥
```cpp
// 鑹ソ绀轰緥
bool FindPlayer(const string& name, PlayerInfo* result);

// 閬垮厤
bool FindPlayer(string name, PlayerInfo& result, int flags, bool exactMatch);
```

## 5. 閿欒澶勭悊

### 5.1 杩斿洖鍊兼鏌?- 妫€鏌ユ墍鏈夊彲鑳藉け璐ョ殑鍑芥暟杩斿洖鍊?- 浣跨敤缁熶竴鐨勯敊璇爜浣撶郴

### 5.2 寮傚父澶勭悊
- 浼樺厛浣跨敤杩斿洖鍊艰€岄潪寮傚父
- 濡傛灉浣跨敤寮傚父锛屾姏瀵硅薄鏈韩鑰岄潪鎸囬拡
- 绂佹鍦ㄦ瀽鏋勫嚱鏁颁腑鎶涘嚭寮傚父

### 5.3 绀轰緥
```cpp
ErrorCode Initialize() {
    if (ag_init_engine() != ErrorCode::Success) {
        return ErrorCode::StandardError;
    }
    // ...
    return ErrorCode::Success;
}
```

## 6. 璧勬簮绠＄悊

### 6.1 鍐呭瓨绠＄悊
- new/delete 閰嶅浣跨敤锛宯ew[]/delete[] 閰嶅浣跨敤
- 浼樺厛浣跨敤鏅鸿兘鎸囬拡
- 璧勬簮閲婃斁鍚庣珛鍗抽噸缃寚閽?
### 6.2 鏂囦欢鎿嶄綔
- 妫€鏌ユ枃浠舵搷浣滆繑鍥炲€?- 纭繚鏂囦欢璺緞缁忚繃瑙勮寖鍖栭獙璇?- 鍒涘缓鏂囦欢鏃舵樉寮忔寚瀹氳闂潈闄?
### 6.3 绀轰緥
```cpp
// 浣跨敤鏅鸿兘鎸囬拡
auto buffer = std::make_unique<char[]>(size);

// 鏂囦欢鎿嶄綔
FILE* file = fopen(path, "r");
if (file == nullptr) {
    // 閿欒澶勭悊
}
// ... 浣跨敤鏂囦欢
fclose(file);
file = nullptr;
```

## 7. 瀹夊叏缂栫▼

### 7.1 杈撳叆楠岃瘉
- 楠岃瘉鎵€鏈夊閮ㄨ緭鍏ユ暟鎹?- 浣跨敤鐧藉悕鍗曢獙璇佽€岄潪榛戝悕鍗?- 妫€鏌ユ暟缁勭储寮曞拰鍐呭瓨鎿嶄綔闀垮害

### 7.2 缂撳啿鍖哄畨鍏?- 閬垮厤缂撳啿鍖烘孩鍑?- 浣跨敤瀹夊叏瀛楃涓插嚱鏁?- 纭繚瀛楃涓蹭互null缁撳熬

### 7.3 绀轰緥
```cpp
// 瀹夊叏鐨勬暟鎹嫹璐?void SafeCopy(char* dest, const char* src, size_t destSize) {
    if (dest == nullptr || src == nullptr || destSize == 0) {
        return;
    }
    size_t copySize = strnlen(src, destSize - 1);
    memcpy(dest, src, copySize);
    dest[copySize] = '\0';
}
```

## 8. 澶存枃浠剁鐞?
### 8.1 澶存枃浠惰亴璐?- 姣忎釜.cpp鏂囦欢搴旀湁瀵瑰簲鐨?h鏂囦欢
- 澶存枃浠跺彧鍖呭惈鎺ュ彛澹版槑
- 閬垮厤澶存枃浠跺惊鐜緷璧?
### 8.2 鍖呭惈淇濇姢
```cpp
#ifndef TFW_SERVER_FRAME_H
#define TFW_SERVER_FRAME_H

// 澶存枃浠跺唴瀹?
#endif // TFW_SERVER_FRAME_H
```

### 8.3 C/C++鍏煎鎬т繚鎶?```cpp
#ifndef TFW_INTERFACE_H
#define TFW_INTERFACE_H

#ifdef __cplusplus
extern "C" {
#endif

// C鎺ュ彛澹版槑
int TFW_FUNCTION_NAME();

#ifdef __cplusplus
}
#endif

#endif // TFW_INTERFACE_H
```

### 8.4 鍖呭惈椤哄簭
1. 瀵瑰簲澶存枃浠?2. C绯荤粺澶存枃浠?3. C++绯荤粺澶存枃浠?4. 鍏朵粬搴撳ご鏂囦欢
5. 椤圭洰澶存枃浠?
### 8.5 绀轰緥
```cpp
// 姝ｇ‘鐨勫寘鍚『搴?#include "server_frame.h"           // 1. 瀵瑰簲澶存枃浠?
#include <cstdio>                   // 2. C绯荤粺澶存枃浠?#include <cstdlib>                  // 2. C绯荤粺澶存枃浠?
#include <iostream>                 // 3. C++绯荤粺澶存枃浠?#include <string>                   // 3. C++绯荤粺澶存枃浠?#include <vector>                   // 3. C++绯荤粺澶存枃浠?
#include <opencv2/opencv.hpp>       // 4. 鍏朵粬搴撳ご鏂囦欢

#include "common/logging.h"         // 5. 椤圭洰澶存枃浠?#include "interface/types.h"        // 5. 椤圭洰澶存枃浠?```

## 9. 绫昏璁?
### 9.1 鏋勯€犱笌鏋愭瀯
- 鎴愬憳鍙橀噺蹇呴』鏄惧紡鍒濆鍖?- 閬靛惊涓?浜?闆舵硶鍒?- 鍩虹被鏋愭瀯鍑芥暟澹版槑涓簐irtual

### 9.2 璁块棶鎺у埗
- 鎸?public, protected, private 椤哄簭澹版槑
- 閬垮厤杩斿洖鍐呴儴鐘舵€佺殑寮曠敤鎴栨寚閽?
### 9.3 绀轰緥
```cpp
class Player {
public:
    explicit Player(const string& name) : name_(name), score_(0) {}

    // 绂佹鎷疯礉
    Player(const Player&) = delete;
    Player& operator=(const Player&) = delete;

    // 鍏佽绉诲姩
    Player(Player&&) = default;
    Player& operator=(Player&&) = default;

    ~Player() = default;

private:
    string name_;
    int score_;
};
```

## 10. 鐜颁唬 C++ 鐗规€?
### 10.1 绫诲瀷鎺ㄦ柇
- 鍚堢悊浣跨敤 auto
- 閬垮厤杩囧害浣跨敤绫诲瀷鎺ㄦ柇

### 10.2 鏅鸿兘鎸囬拡
- 浼樺厛浣跨敤 std::make_unique
- 鍗曚緥銆佹垚鍛樺彉閲忕瓑浼樺厛浣跨敤鍘熷鎸囬拡

### 10.3 Lambda 琛ㄨ揪寮?- 褰撳嚱鏁颁笉鑳藉伐浣滄椂浣跨敤lambda
- 閬垮厤鎸夊紩鐢ㄦ崟鑾峰彲鑳介€冮€哥殑灞€閮ㄥ彉閲?
### 10.4 绀轰緥
```cpp
// 浣跨敤 auto
auto player = std::make_unique<Player>("test");

// 浣跨敤 lambda
std::for_each(players.begin(), players.end(), [](const auto& player) {
    player.Update();
});
```

## 11. 鏃ュ織瑙勮寖

### 11.1 鏃ュ織鏍煎紡
`yyyy-MM-dd hh:mm:ss.ms pid tid L [MODULE] (file:line) func: message`

### 11.2 鏃ュ織绛夌骇
- D: Debug
- I: Info
- W: Warning
- E: Error
- F: Fatal

### 11.3 妯″潡鍖哄垎
- CORE: 鏍稿績妗嗘灦
- UTILS: 閫氱敤宸ュ叿
- SDK: 寮€鍙戝伐鍏峰寘
- SYSTEM: 绯荤粺鎿嶄綔

### 11.4 绀轰緥
```cpp
LOG_INFO_CORE("Engine initialized successfully");
LOG_ERROR_SYSTEM("Failed to connect device: {}", errorMsg);
```

### 11.5 鏃ュ織瀹忓畾涔?```cpp
// 妯″潡瀹氫箟
enum LogModule {
    MODULE_CORE = 0,
    MODULE_UTILS = 1,
    MODULE_SDK = 2,
    MODULE_SYSTEM = 3
};

// 鏃ュ織瀹?#define LOG(module, level, message) // 瀹炵幇
#define LOG_CORE(level, message) LOG(MODULE_CORE, level, message)
#define LOG_INFO_CORE(message) LOG_CORE(LOG_INFO, message)
```

## 12. 澶氱嚎绋嬪畨鍏?
### 12.1 绾跨▼瀹夊叏
- 鏄庣‘鏍囪瘑绾跨▼瀹夊叏鍑芥暟
- 浣跨敤閫傚綋鐨勫悓姝ユ満鍒?- 閬垮厤姝婚攣鍜岀珵鎬佹潯浠?
### 12.2 鍘熷瓙鎿嶄綔
- 浣跨敤 std::atomic 杩涜鏃犻攣缂栫▼
- 閬垮厤涓嶅繀瑕佺殑鍘熷瓙鎿嶄綔寮€閿€

## 13. 鎬ц兘鑰冭檻

### 13.1 鍐呭瓨浣跨敤
- 閬垮厤涓嶅繀瑕佺殑鍐呭瓨鍒嗛厤
- 浣跨敤瀵硅薄姹犲鐢ㄨ祫婧?- 娉ㄦ剰缂撳瓨鍙嬪ソ鎬?
### 13.2 绠楁硶閫夋嫨
- 閫夋嫨閫傚綋鐨勬暟鎹粨鏋?- 閬垮厤涓嶅繀瑕佺殑鎷疯礉
- 浣跨敤绉诲姩璇箟鍑忓皯鎷疯礉

## 14. 鍏ㄥ眬鍙橀噺瑙勮寖

### 14.1 鍛藉悕瑙勮寖
- 鍏ㄥ眬鍙橀噺浣跨敤灏忛┘宄板懡鍚嶆硶
- 浠?`g_` 寮€澶达紝琛ㄧず鍏ㄥ眬浣滅敤鍩?- 閬垮厤浣跨敤鍗曞瓧姣嶅叏灞€鍙橀噺

### 14.2 浣跨敤鍘熷垯
- 灏介噺鍑忓皯鍏ㄥ眬鍙橀噺鐨勪娇鐢?- 鍏ㄥ眬鍙橀噺蹇呴』鏄惧紡鍒濆鍖?- 鑰冭檻浣跨敤鍗曚緥妯″紡鏇夸唬鍏ㄥ眬鍙橀噺

### 14.3 绀轰緥
```cpp
// 姝ｇ‘鐨勫叏灞€鍙橀噺鍛藉悕
int g_totalConnections = 0;
string g_defaultConfig = "default.conf";
bool g_debugMode = false;

// 閬垮厤鐨勫懡鍚?int total = 0;           // 缂哄皯g_鍓嶇紑
string DEFAULT_CONFIG;   // 浣跨敤鍏ㄥぇ鍐欙紙搴斾负甯搁噺锛?bool debug = false;      // 缂哄皯g_鍓嶇紑
```

## 15. 甯搁噺瀹氫箟瑙勮寖

### 15.1 鍛藉悕瑙勮寖
- 甯搁噺浣跨敤鍏ㄥぇ鍐欙紝涓嬪垝绾垮垎闅?- 绫诲唴甯搁噺浣跨敤鍏ㄥぇ鍐?- 鏋氫妇鍊间娇鐢ㄥ叏澶у啓

### 15.2 瀹氫箟鏂瑰紡
- 浼樺厛浣跨敤 constexpr
- 绫诲唴甯搁噺浣跨敤 static const
- 閬垮厤浣跨敤 #define 瀹氫箟甯搁噺

### 15.3 绀轰緥
```cpp
// 鍏ㄥ眬甯搁噺
constexpr int MAX_CONNECTIONS = 100;
constexpr float DEFAULT_TIMEOUT = 30.0f;

// 绫诲唴甯搁噺
class ConnectionManager {
public:
    static const int MAX_RETRY_COUNT = 3;
    static const string DEFAULT_HOST = "localhost";
};

// 鏋氫妇甯搁噺
enum class ConnectionState {
    DISCONNECTED = 0,
    CONNECTING = 1,
    CONNECTED = 2,
    ERROR = 3
};
```

## 16. C鎺ュ彛鍏煎鎬ц鑼?
### 16.1 鍩烘湰鍘熷垯
- **瑙勫垯**: 鎵€鏈夋牳蹇冩帴鍙ｅ繀椤绘彁渚汣璇█鍏煎鐗堟湰
- **鐩殑**: 鏀寔澶氱缂栫▼璇█璋冪敤锛屾彁楂樻鏋堕€氱敤鎬?- **瑕佹眰**: 浣跨敤extern "C"澹版槑锛岀‘淇滳++缂栬瘧鍣ㄦ纭鐞?
### 16.2 C鎺ュ彛鍛藉悕瑙勮寖
- 鍑芥暟鍚嶄娇鐢ㄥ叏澶у啓锛屼笅鍒掔嚎鍒嗛殧
- 浠ユā鍧楀悕寮€澶达紝濡俙TFW_CORE_`銆乣TFW_UTILS_`
- 閬垮厤浣跨敤C++鐗规€э紝濡傞噸杞姐€佹ā鏉跨瓑

### 16.3 澶存枃浠剁粨鏋?```cpp
#ifndef TFW_INTERFACE_H
#define TFW_INTERFACE_H

// C++閮ㄥ垎
#ifdef __cplusplus
#include <string>
namespace TFW {
    class Core {
        // C++绫诲畾涔?    };
}
#endif

// C鎺ュ彛閮ㄥ垎
#ifdef __cplusplus
extern "C" {
#endif

// C鎺ュ彛鍑芥暟澹版槑
int TFW_CORE_INITIALIZE();
int TFW_CORE_EXIT();
int TFW_UTILS_GET_VERSION(char* version, int maxLen);

#ifdef __cplusplus
}
#endif

#endif // TFW_INTERFACE_H
```

### 16.4 C鎺ュ彛瀹炵幇瑕佹眰
- 鍦?cpp鏂囦欢涓疄鐜癈鎺ュ彛鍑芥暟
- C鎺ュ彛鍑芥暟鍐呴儴璋冪敤C++绫绘柟娉?- 澶勭悊C++寮傚父锛岃浆鎹负C閿欒鐮?- 鎻愪緵鍐呭瓨绠＄悊鎺ュ彛锛堝闇€瑕侊級

### 16.5 绀轰緥
```cpp
// C鎺ュ彛瀹炵幇
extern "C" int TFW_CORE_INITIALIZE() {
    try {
        return static_cast<int>(TFW::Core::GetInstance().Initialize());
    } catch (...) {
        return static_cast<int>(TFW::ErrorCode::StandardError);
    }
}

extern "C" int TFW_CORE_EXIT() {
    try {
        return static_cast<int>(TFW::Core::GetInstance().Exit());
    } catch (...) {
        return static_cast<int>(TFW::ErrorCode::StandardError);
    }
}
```

### 16.6 閿欒澶勭悊
- C鎺ュ彛浣跨敤鏁存暟閿欒鐮?- 鎴愬姛杩斿洖0锛岄敊璇繑鍥炶礋鏁?- 鎻愪緵閿欒鐮佸埌瀛楃涓茬殑杞崲鍑芥暟
- 淇濇寔涓嶤++閿欒鐮佺殑涓€鑷存€?
## 闄勫綍: 甯哥敤瀹忓畾涔?
```cpp
// 妯″潡瀹氫箟
#define MODULE_CORE    0
#define MODULE_UTILS   1
#define MODULE_SDK     2
#define MODULE_SYSTEM  3

// 鏃ュ織瀹?#define LOG(module, level, message) // 瀹炵幇
#define LOG_CORE(level, message) LOG(MODULE_CORE, level, message)
#define LOG_INFO_CORE(message) LOG_CORE(LOG_INFO, message)

// 閿欒鐮?#define ERROR_SUCCESS 0
#define ERROR_INVALID_PARAM 1
// ...

// C鎺ュ彛瀹?#define TFW_API extern "C"
#define TFW_EXPORT __declspec(dllexport)  // Windows
#define TFW_IMPORT __declspec(dllimport)  // Windows
```

## 鐗堟湰鍘嗗彶
- v1.0 (2025-08-23): 鍒濆鐗堟湰锛屽熀浜?OpenHarmony 瑙勮寖閫傞厤 TFW 椤圭洰
- v1.1 (2025-08-23): 琛ュ厖鍏ㄥ眬鍙橀噺鍛藉悕銆佸父閲忓畾涔夌瓑瑙勮寖
- v1.2 (2025-08-23): 鏂板C鎺ュ彛鍏煎鎬ц鑼?
**璁颁綇**: 缂栫爜瑙勮寖鏄洟闃熷崗浣滅殑鍩虹锛岃涓ユ牸閬靛畧锛?